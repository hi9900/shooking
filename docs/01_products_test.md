# 상품 목록 페이지 테스트 계획서

## 1. 개요

본 문서는 '상품 목록 페이지' 기능 구현에 대한 테스트 전략과 상세 시나리오를 정의합니다.

테스트의 목적은 컴포넌트 단위의 UI 렌더링부터 비동기 데이터 로딩, 전역 상태(Context)를 이용한 복잡한 상호작용까지 모든 기능이 의도대로 작동하는지 검증하고, 향후 리팩토링 및 기능 추가 시 발생할 수 있는 잠재적 버그를 사전에 방지하는 데 있습니다.

## 2. 테스트 환경 및 도구

- Test Runner: `Jest`
- Test Library: `React Testing Library (RTL)`
- User Interaction: `@testing-library/user-event`
- DOM Assertions: `@testing-library/jest-dom`

## 3. 테스트 시나리오

테스트는 기능의 복잡도와 의존성에 따라 '단위/컴포넌트', '비동기', '통합'의 세 가지 범주로 분류합니다.

### 3-1. 단위 및 기본 렌더링 테스트 (Unit & Component)

가장 작은 단위의 순수 함수와 UI 컴포넌트가 주어진 `props`에 따라 올바르게 렌더링되는지 검증합니다.

#### 3-1-1. 유틸리티 함수: `formatPrice()` (단위 테스트)

| 테스트 ID | 시나리오  | 입력값    | 기댓값          |
| :-------- | :-------- | :-------- | :-------------- |
| UT-01     | 기본 통화 | `1000`    | `'1,000원'`     |
| UT-02     | 큰 숫자   | `1234567` | `'1,234,567원'` |
| UT-03     | 0         | `0`       | `'0원'`         |
| UT-04     | 음수      | `-5000`   | `'-5,000원'`    |

#### 3-1-2. `Button` 컴포넌트 (렌더링 테스트)

- CT-01 (텍스트 렌더링): `text="담기"` prop 전달 시, '담기' 텍스트를 가진 버튼이 렌더링된다.
- CT-02 (스타일 적용): `dataSize="small"` 및 `dataType="secondary"` prop 전달 시, 버튼은 `small` (`px-3.5`)과 `secondary` (`outline`) 스타일에 해당하는 CSS 클래스를 포함한다.
- CT-03 (비활성화 렌더링): `disabled={true}` prop 전달 시, 버튼은 `disabled` 속성을 가진 상태로 렌더링된다.

#### 3-1-3. `Header` 컴포넌트 (렌더링 테스트)

- CT-04 (기본 렌더링): `CartProvider`로 감싼 `Header` 렌더링 시, 로고(`alt="Shooking 로고"`)와 장바구니 아이콘(`alt="장바구니"`)이 화면에 표시된다.
- CT-05 (초기 뱃지 상태): 장바구니가 비어있는 상태에서 렌더링 시, 숫자 뱃지(카운트)는 DOM에 존재하지 않아야 한다. (검증: `queryBy`)

#### 3-1-4. `ProductCard` 컴포넌트 (렌더링 테스트)

- CT-06 (데이터 표시): `product` prop으로 상품 정보 전달 시, 상품명, 브랜드명, 포맷된 가격이 모두 화면에 표시된다.
- CT-07 (초기 버튼 상태): 장바구니가 비어있는 상태에서 렌더링 시, 카드 내 버튼은 "담기" 텍스트를 표시하고 활성화(not disabled) 상태여야 한다.

---

### 3-2. 비동기 로직 테스트 (Asynchronous)

API 호출과 같이 즉시 완료되지 않는 비동기 작업의 여러 상태(로딩, 성공, 실패)에 따라 UI가 올바르게 변화하는지 검증합니다.

- TODO:

<!-- #### 3-2-1. `ProductListPage` API 호출 (컴포넌트 테스트)

- AT-01 (초기 로딩 상태): 컴포넌트 렌더링 시, 1페이지 API 응답이 오기 전까지 "로딩 중..." 텍스트가 표시된다.
- AT-02 (초기 성공 상태): 1페이지 API 호출이 성공하고 10개의 상품 목록을 반환하면, "로딩 중..." 텍스트는 사라지고 10개의 `ProductCard`가 렌더링된다.
- AT-03 (초기 실패 상태): 1페이지 API 호출이 실패(에러 발생)하면, "로딩 중..." 텍스트는 사라지고 "에러가 발생했습니다"와 같은 오류 메시지가 표시된다.
- AT-04 (다음 페이지 로드 트리거): 1페이지가 성공적으로 로드된 상태에서, 사용자가 페이지 하단(IntersectionObserver가 감지하는 지점)으로 스크롤하면 2페이지에 대한 API 호출이 발생해야 한다.
- AT-05 (다음 페이지 로딩 UI): 1페이지가 로드된 후 사용자가 하단으로 스크롤하여 2페이지를 요청할 때, 2페이지 데이터가 도착하기 전까지 리스트 하단에 로딩 스피너(또는 '불러오는 중...')가 표시되어야 한다.
- AT-06 (데이터 누적 (Append)): 2페이지 API 호출이 성공하고 10개의 상품을 추가로 반환하면, 기존 1페이지의 10개 상품은 그대로 유지된 채 목록 하단에 10개가 추가되어 총 20개의 상품이 렌더링되어야 한다.
- AT-07 (마지막 페이지 처리): API가 '마지막 페이지'라고 응답한 후(예: 빈 배열 반환), 사용자가 다시 하단으로 스크롤해도 추가 API 호출이 발생하지 않아야 한다. (선택: '더 이상 상품이 없습니다' 메시지 표시)
-->

---

### 3-3. 상호작용 및 통합 테스트 (Integration)

사용자의 행동(클릭 등)과 여러 컴포넌트가 `Context`를 통해 엮여 상태가 변화하는 복잡한 시나리오를 검증합니다.

#### 3-3-1. `Button` 컴포넌트 클릭 이벤트 (상호작용 테스트)

- IT-01 (클릭 이벤트): `onClick` 핸들러(Mock 함수)를 전달하고 버튼을 클릭하면, 핸들러 함수가 정확히 1번 호출된다.
- IT-02 (비활성화 시 클릭): `disabled` 상태의 버튼을 클릭하면, `onClick` 핸들러 함수가 호출되지 않는다.

#### 3-3-2. 장바구니 담기 기능 (통합 테스트)

- IT-03 (상품 담기):
  - Given: `CartProvider` 내부에 `ProductCard`가 렌더링되고, 장바구니는 비어있다.
  - When: 사용자가 "담기" 버튼을 클릭한다.
  - Then: 버튼의 텍스트가 "담김!"으로 변경되고, `bg-zinc-300` 스타일이 적용된다.
- IT-04 (이미 담긴 상품):
  - Given: 장바구니에 해당 상품이 이미 포함된 상태로 `ProductCard`가 렌더링된다.
  - When: 컴포넌트 렌더링이 완료된다.
  - Then: 버튼은 처음부터 "담김!" 텍스트와 `bg-zinc-300` 스타일로 표시된다.
- IT-05 (헤더 연동):
  - Given: `CartProvider` 내부에 `Header`와 `ProductCard`가 함께 렌더링되고, 헤더의 카트 뱃지는 보이지 않는다.
  - When: `ProductCard`의 "담기" 버튼을 클릭한다.
  - Then: `Header`의 카트 뱃지가 '1'이라는 텍스트와 함께 표시된다.

---
